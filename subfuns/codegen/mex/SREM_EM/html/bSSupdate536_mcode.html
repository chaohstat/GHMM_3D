<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="134,1" id="srcline1">1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T13U3">beta0</span>, <span class="var type1" id="S3T39U4">Sigma_s0</span>] = bSSupdate(<span class="var type1" id="S4T11U7">Y1</span>,<span class="var type1" id="S5T55U8">Pb</span>,<span class="var type1" id="S6T72U9">W1</span>,<span class="var type1" id="S7T13U10">beta</span>,<span class="var type1" id="S8T74U11">exbetabar</span>,<span class="var type1" id="S9T1U12">q</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="134,2" id="srcline2">2</a></span><span class="line"><span class="mxinfo " id="T1:U9">[<span class="var type1" id="S10T1U16">m</span>,<span class="var type1" id="S11T1U17">N1</span>] = size(<span class="var type1" id="S4T11U20">Y1</span>)</span>; <span class="mxinfo " id="T13:U13"><span class="var type1" id="S2T13U23">beta0</span> = <span class="mxinfo " id="T13:U15">zeros(<span class="var type1" id="S9T1U26">q</span>,<span class="var type1" id="S10T1U27">m</span>)</span></span>; <span class="mxinfo " id="T39:U18"><span class="var type1" id="S3T39U30">Sigma_s0</span> = <span class="mxinfo " id="T39:U20">zeros(<span class="mxinfo " id="T1:U21">1</span>,<span class="var type1" id="S10T1U34">m</span>)</span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="134,3" id="srcline3">3</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S14T1U37">ll</span> = <span class="mxinfo " id="T1:U24">1</span>:<span class="var type1" id="S10T1U40">m</span></span></span>
<span class="srcline"><span class="lineno"><a href="134,4" id="srcline4">4</a></span><span class="line">    <span class="mxinfo " id="T79:U26"><span class="var type1" id="S15T79U43">z</span> = <span class="mxinfo " id="T79:U28"><span class="mxinfo " id="T79:U29"><span class="mxinfo " id="T83:U30"><span class="var type1" id="S4T11U47">Y1</span>(<span class="var type1" id="S14T1U48">ll</span>,:)</span>'</span>-<span class="mxinfo " id="T79:U33">diag(<span class="mxinfo " id="T90:U34"><span class="mxinfo " id="T86:U35"><span class="mxinfo " id="T3:U36"><span class="var type1" id="S6T72U55">W1</span>'</span>*<span class="var type1" id="S8T74U56">exbetabar</span></span>*<span class="mxinfo " id="T89:U39"><span class="var type1" id="S5T55U58">Pb</span>(:,:,<span class="var type1" id="S14T1U61">ll</span>)</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="134,5" id="srcline5">5</a></span><span class="line">    <span class="mxinfo " id="T93:U42"><span class="mxinfo " id="T93:U43"><span class="var type1" id="S2T13U65">beta0</span>(:,<span class="var type1" id="S14T1U67">ll</span>)</span> = <span class="mxinfo " id="T76:U46"><span class="mxinfo " id="T72:U47"><span class="mxinfo " id="T11:U48"><span class="var type1" id="S6T72U71">W1</span>*<span class="mxinfo " id="T3:U50"><span class="var type1" id="S6T72U73">W1</span>'</span></span>\<span class="var type1" id="S6T72U74">W1</span></span>*<span class="mxinfo " id="T79:U53"><span class="var type1" id="S15T79U76">z</span>(:,<span class="mxinfo " id="T1:U55">1</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="134,6" id="srcline6">6</a></span><span class="line">    <span class="mxinfo " id="T1:U56"><span class="mxinfo " id="T1:U57"><span class="var type1" id="S3T39U82">Sigma_s0</span>(<span class="var type1" id="S14T1U83">ll</span>)</span> = <span class="mxinfo " id="T1:U60"><span class="mxinfo " id="T1:U61"><span class="mxinfo " id="T83:U62">(<span class="mxinfo " id="T79:U63"><span class="var type1" id="S15T79U89">z</span>-<span class="mxinfo " id="T76:U65"><span class="mxinfo " id="T3:U66"><span class="var type1" id="S6T72U92">W1</span>'</span>*<span class="mxinfo " id="T93:U68"><span class="var type1" id="S7T13U94">beta</span>(:,<span class="var type1" id="S14T1U96">ll</span>)</span></span></span>)'</span>*(<span class="mxinfo " id="T79:U71"><span class="var type1" id="S15T79U99">z</span>-<span class="mxinfo " id="T76:U73"><span class="mxinfo " id="T3:U74"><span class="var type1" id="S6T72U102">W1</span>'</span>*<span class="mxinfo " id="T93:U76"><span class="var type1" id="S2T13U104">beta0</span>(:,<span class="var type1" id="S14T1U106">ll</span>)</span></span></span>)</span>/<span class="var type1" id="S11T1U107">N1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="134,7" id="srcline7">7</a></span><span class="line"><span class="keyword"><span class="keyword">end</span></span></span></span>
</pre>
