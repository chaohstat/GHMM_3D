<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="143,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T1U3">f1</span>,<span class="var type1" id="S3T1U4">f2</span>] = taufun(<span class="var type1" id="S4T1U7">tau</span>,<span class="var type1" id="S5T11U8">b</span>,<span class="var type1" id="S6T11U9">Y11DIC</span>,<span class="var type1" id="S7T1U10">N0</span>,<span class="var type1" id="S8T16U11">DIC</span>,<span class="var type1" id="S9T76U12">DICind</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="143,2" id="srcline2"> 2</a></span><span class="line"><span class="mxinfo " id="T1:U9"><span class="var type1" id="S2T1U15">f1</span> = <span class="mxinfo " id="T1:U11">0</span></span>; <span class="mxinfo " id="T1:U12"><span class="var type1" id="S3T1U19">f2</span> = <span class="mxinfo " id="T1:U14">0</span></span>; <span class="mxinfo " id="T1:U15"><span class="var type1" id="S10T1U23">LnPL</span> = <span class="mxinfo " id="T1:U17">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="143,3" id="srcline3"> 3</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S11T1U27">ii</span>=<span class="mxinfo " id="T1:U19">1</span>:<span class="var type1" id="S7T1U30">N0</span></span></span>
<span class="srcline"><span class="lineno"><a href="143,4" id="srcline4"> 4</a></span><span class="line">    <span class="mxinfo " id="T76:U21"><span class="var type1" id="S12T76U33">b0</span>=<span class="mxinfo " id="T76:U23"><span class="var type1" id="S5T11U35">b</span>(:,<span class="var type1" id="S11T1U37">ii</span>)</span></span>; <span class="mxinfo " id="T76:U26"><span class="var type1" id="S13T76U40">y</span>=<span class="mxinfo " id="T76:U28"><span class="var type1" id="S6T11U42">Y11DIC</span>(:,<span class="var type1" id="S11T1U44">ii</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="143,5" id="srcline5"> 5</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S14T1U47">kk</span>=<span class="mxinfo " id="T1:U32">1</span>:<span class="mxinfo " id="T1:U33">length(<span class="var type1" id="S9T76U52">DICind</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="143,6" id="srcline6"> 6</a></span><span class="line">        <span class="mxinfo " id="T94:U35"><span class="var type1" id="S16T94U55">sind</span> = <span class="mxinfo " id="T94:U37">find(<span class="mxinfo " id="T97:U38"><span class="mxinfo " id="T94:U39"><span class="var type1" id="S8T16U60">DIC</span>(<span class="mxinfo " id="T1:U41"><span class="var type1" id="S9T76U62">DICind</span>(<span class="var type1" id="S14T1U63">kk</span>)</span>,:)</span>==<span class="mxinfo " id="T1:U44">1</span></span>)</span></span>; <span class="mxinfo " id="T95:U45"><span class="var type1" id="S18T95U68">ytemp</span>=<span class="mxinfo " id="T95:U47"><span class="mxinfo " id="T95:U48"><span class="var type1" id="S13T76U71">y</span>(<span class="var type1" id="S16T94U72">sind</span>)</span>-<span class="mxinfo " id="T1:U51"><span class="var type1" id="S13T76U74">y</span>(<span class="var type1" id="S14T1U75">kk</span>)</span></span></span>; <span class="mxinfo " id="T95:U54"><span class="var type1" id="S19T95U78">Dis</span>=<span class="mxinfo " id="T95:U56">exp(<span class="mxinfo " id="T76:U57"><span class="mxinfo " id="T1:U58">-0.5</span>*<span class="mxinfo " id="T95:U59">abs(<span class="var type1" id="S18T95U86">ytemp</span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="143,7" id="srcline7"> 7</a></span><span class="line">        <span class="mxinfo " id="T1:U61"><span class="var type1" id="S22T1U89">ub</span> = <span class="mxinfo " id="T1:U63"><span class="mxinfo " id="T94:U64"><span class="var type1" id="S19T95U92">Dis</span>'</span>*<span class="mxinfo " id="T79:U66">real(<span class="mxinfo " id="T113:U67"><span class="mxinfo " id="T95:U68"><span class="var type1" id="S12T76U97">b0</span>(<span class="var type1" id="S16T94U98">sind</span>)</span>==<span class="mxinfo " id="T1:U71"><span class="var type1" id="S12T76U100">b0</span>(<span class="var type1" id="S14T1U101">kk</span>)</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="143,8" id="srcline8"> 8</a></span><span class="line">        <span class="mxinfo " id="T1:U74"><span class="var type1" id="S24T1U104">ub1</span> = <span class="mxinfo " id="T1:U76"><span class="mxinfo " id="T94:U77"><span class="var type1" id="S19T95U107">Dis</span>'</span>*<span class="mxinfo " id="T79:U79">real(<span class="mxinfo " id="T113:U80"><span class="mxinfo " id="T95:U81"><span class="var type1" id="S12T76U112">b0</span>(<span class="var type1" id="S16T94U113">sind</span>)</span>==<span class="mxinfo " id="T1:U84">0</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="143,9" id="srcline9"> 9</a></span><span class="line">        <span class="mxinfo " id="T1:U85"><span class="var type1" id="S25T1U117">ub2</span> = <span class="mxinfo " id="T1:U87"><span class="mxinfo " id="T94:U88"><span class="var type1" id="S19T95U120">Dis</span>'</span>*<span class="mxinfo " id="T79:U90">real(<span class="mxinfo " id="T113:U91"><span class="mxinfo " id="T95:U92"><span class="var type1" id="S12T76U125">b0</span>(<span class="var type1" id="S16T94U126">sind</span>)</span>==<span class="mxinfo " id="T1:U95">1</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="143,10" id="srcline10">10</a></span><span class="line">        <span class="mxinfo " id="T1:U96"><span class="var type1" id="S26T1U130">ub3</span> = <span class="mxinfo " id="T1:U98"><span class="mxinfo " id="T94:U99"><span class="var type1" id="S19T95U133">Dis</span>'</span>*<span class="mxinfo " id="T79:U101">real(<span class="mxinfo " id="T113:U102"><span class="mxinfo " id="T95:U103"><span class="var type1" id="S12T76U138">b0</span>(<span class="var type1" id="S16T94U139">sind</span>)</span>==<span class="mxinfo " id="T1:U106">2</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="143,11" id="srcline11">11</a></span><span class="line">        <span class="mxinfo " id="T1:U107"><span class="var type1" id="S10T1U143">LnPL</span> = <span class="mxinfo " id="T1:U109"><span class="mxinfo " id="T1:U110"><span class="var type1" id="S10T1U146">LnPL</span>+<span class="mxinfo " id="T1:U112"><span class="var type1" id="S22T1U148">ub</span>*<span class="var type1" id="S4T1U149">tau</span></span></span>-<span class="mxinfo " id="T1:U115">log(<span class="mxinfo " id="T1:U116"><span class="mxinfo " id="T1:U117"><span class="mxinfo " id="T1:U118">exp(<span class="mxinfo " id="T1:U119"><span class="var type1" id="S4T1U157">tau</span>*<span class="var type1" id="S24T1U158">ub1</span></span>)</span>+<span class="mxinfo " id="T1:U122">exp(<span class="mxinfo " id="T1:U123"><span class="var type1" id="S4T1U162">tau</span>*<span class="var type1" id="S25T1U163">ub2</span></span>)</span></span>+<span class="mxinfo " id="T1:U126">exp(<span class="mxinfo " id="T1:U127"><span class="var type1" id="S4T1U167">tau</span>*<span class="var type1" id="S26T1U168">ub3</span></span>)</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="143,12" id="srcline12">12</a></span><span class="line">        <span class="mxinfo " id="T1:U130"><span class="var type1" id="S2T1U171">f1</span> = <span class="mxinfo " id="T1:U132"><span class="mxinfo " id="T1:U133"><span class="var type1" id="S2T1U174">f1</span>+<span class="var type1" id="S22T1U175">ub</span></span>-<span class="mxinfo " id="T1:U136">(<span class="mxinfo " id="T1:U137"><span class="mxinfo " id="T1:U138"><span class="mxinfo " id="T1:U139"><span class="var type1" id="S24T1U181">ub1</span>*<span class="mxinfo " id="T1:U141">exp(<span class="mxinfo " id="T1:U142"><span class="var type1" id="S4T1U185">tau</span>*<span class="var type1" id="S24T1U186">ub1</span></span>)</span></span>+<span class="mxinfo " id="T1:U145"><span class="var type1" id="S25T1U188">ub2</span>*<span class="mxinfo " id="T1:U147">exp(<span class="mxinfo " id="T1:U148"><span class="var type1" id="S4T1U192">tau</span>*<span class="var type1" id="S25T1U193">ub2</span></span>)</span></span></span>+<span class="mxinfo " id="T1:U151"><span class="var type1" id="S26T1U195">ub3</span>*<span class="mxinfo " id="T1:U153">exp(<span class="mxinfo " id="T1:U154"><span class="var type1" id="S4T1U199">tau</span>*<span class="var type1" id="S26T1U200">ub3</span></span>)</span></span></span>)/(<span class="mxinfo " id="T1:U157"><span class="mxinfo " id="T1:U158"><span class="mxinfo " id="T1:U159">exp(<span class="mxinfo " id="T1:U160"><span class="var type1" id="S4T1U207">tau</span>*<span class="var type1" id="S24T1U208">ub1</span></span>)</span>+<span class="mxinfo " id="T1:U163">exp(<span class="mxinfo " id="T1:U164"><span class="var type1" id="S4T1U212">tau</span>*<span class="var type1" id="S25T1U213">ub2</span></span>)</span></span>+<span class="mxinfo " id="T1:U167">exp(<span class="mxinfo " id="T1:U168"><span class="var type1" id="S4T1U217">tau</span>*<span class="var type1" id="S26T1U218">ub3</span></span>)</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="143,13" id="srcline13">13</a></span><span class="line">        <span class="mxinfo " id="T1:U171"><span class="var type1" id="S3T1U221">f2</span> = <span class="mxinfo " id="T1:U173"><span class="mxinfo " id="T1:U174"><span class="var type1" id="S3T1U224">f2</span>-<span class="mxinfo " id="T1:U176">(<span class="mxinfo " id="T1:U177"><span class="mxinfo " id="T1:U178"><span class="mxinfo " id="T1:U179"><span class="mxinfo " id="T1:U180"><span class="var type1" id="S24T1U231">ub1</span>^2</span>*<span class="mxinfo " id="T1:U182">exp(<span class="mxinfo " id="T1:U183"><span class="var type1" id="S4T1U236">tau</span>*<span class="var type1" id="S24T1U237">ub1</span></span>)</span></span>+<span class="mxinfo " id="T1:U186"><span class="mxinfo " id="T1:U187"><span class="var type1" id="S25T1U240">ub2</span>^2</span>*<span class="mxinfo " id="T1:U189">exp(<span class="mxinfo " id="T1:U190"><span class="var type1" id="S4T1U245">tau</span>*<span class="var type1" id="S25T1U246">ub2</span></span>)</span></span></span>+<span class="mxinfo " id="T1:U193"><span class="mxinfo " id="T1:U194"><span class="var type1" id="S26T1U249">ub3</span>^2</span>*<span class="mxinfo " id="T1:U196">exp(<span class="mxinfo " id="T1:U197"><span class="var type1" id="S4T1U254">tau</span>*<span class="var type1" id="S26T1U255">ub3</span></span>)</span></span></span>)/(<span class="mxinfo " id="T1:U200"><span class="mxinfo " id="T1:U201"><span class="mxinfo " id="T1:U202">exp(<span class="mxinfo " id="T1:U203"><span class="var type1" id="S4T1U262">tau</span>*<span class="var type1" id="S24T1U263">ub1</span></span>)</span>+<span class="mxinfo " id="T1:U206">exp(<span class="mxinfo " id="T1:U207"><span class="var type1" id="S4T1U267">tau</span>*<span class="var type1" id="S25T1U268">ub2</span></span>)</span></span>+<span class="mxinfo " id="T1:U210">exp(<span class="mxinfo " id="T1:U211"><span class="var type1" id="S4T1U272">tau</span>*<span class="var type1" id="S26T1U273">ub3</span></span>)</span></span>)</span></span><span class="keyword">...</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="143,14" id="srcline14">14</a></span><span class="line"><span class="mxinfo " id="T1:U171"><span class="mxinfo " id="T1:U173">            +<span class="mxinfo " id="T1:U214"><span class="mxinfo " id="T1:U215">(<span class="mxinfo " id="T1:U216"><span class="mxinfo " id="T1:U217"><span class="mxinfo " id="T1:U218"><span class="var type1" id="S24T1U280">ub1</span>*<span class="mxinfo " id="T1:U220">exp(<span class="mxinfo " id="T1:U221"><span class="var type1" id="S4T1U284">tau</span>*<span class="var type1" id="S24T1U285">ub1</span></span>)</span></span>+<span class="mxinfo " id="T1:U224"><span class="var type1" id="S25T1U287">ub2</span>*<span class="mxinfo " id="T1:U226">exp(<span class="mxinfo " id="T1:U227"><span class="var type1" id="S4T1U291">tau</span>*<span class="var type1" id="S25T1U292">ub2</span></span>)</span></span></span>+<span class="mxinfo " id="T1:U230"><span class="var type1" id="S26T1U294">ub3</span>*<span class="mxinfo " id="T1:U232">exp(<span class="mxinfo " id="T1:U233"><span class="var type1" id="S4T1U298">tau</span>*<span class="var type1" id="S26T1U299">ub3</span></span>)</span></span></span>)^2</span>/<span class="mxinfo " id="T1:U236">(<span class="mxinfo " id="T1:U237"><span class="mxinfo " id="T1:U238"><span class="mxinfo " id="T1:U239">exp(<span class="mxinfo " id="T1:U240"><span class="var type1" id="S4T1U308">tau</span>*<span class="var type1" id="S24T1U309">ub1</span></span>)</span>+<span class="mxinfo " id="T1:U243">exp(<span class="mxinfo " id="T1:U244"><span class="var type1" id="S4T1U313">tau</span>*<span class="var type1" id="S25T1U314">ub2</span></span>)</span></span>+<span class="mxinfo " id="T1:U247">exp(<span class="mxinfo " id="T1:U248"><span class="var type1" id="S4T1U318">tau</span>*<span class="var type1" id="S26T1U319">ub3</span></span>)</span></span>)^2</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="143,15" id="srcline15">15</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="143,16" id="srcline16">16</a></span><span class="line"><span class="keyword"><span class="keyword">end</span></span></span></span>
</pre>
